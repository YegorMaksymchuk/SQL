CREATE SCHEMA `MARVEL` DEFAULT CHARACTER SET utf8mb4;

CREATE TABLE `MARVEL`.SUPERHERO (
  ID   BIGINT AUTO_INCREMENT PRIMARY KEY,
  NAME VARCHAR(50) UNIQUE NOT NULL
);

CREATE TABLE `MARVEL`.SKILLS (
  ID    BIGINT AUTO_INCREMENT PRIMARY KEY,
  SKILL VARCHAR(50) UNIQUE NOT NULL
);

CREATE TABLE `MARVEL`.`SUPERHERO_SKILLS` (
  `SUPERHERO_ID` BIGINT,
  `SKILLS_ID`     BIGINT,
  PRIMARY KEY (`SUPERHERO_ID`, `SKILLS_ID`),
  CONSTRAINT FK_ID_SUPERHERO FOREIGN KEY (SUPERHERO_ID) REFERENCES MARVEL.SUPERHERO (ID) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT FK_ID_SKILL FOREIGN KEY (SKILLS_ID) REFERENCES MARVEL.SKILLS (ID) ON DELETE CASCADE ON UPDATE CASCADE);


INSERT INTO `MARVEL`.`SUPERHERO` (`ID`, `NAME`) VALUES ('1', 'SuperMan');
INSERT INTO `MARVEL`.`SUPERHERO` (`ID`, `NAME`) VALUES ('2', 'IronMan');
INSERT INTO `MARVEL`.`SUPERHERO` (`ID`, `NAME`) VALUES ('3', 'Halk');
INSERT INTO `MARVEL`.`SUPERHERO` (`ID`, `NAME`) VALUES ('4', 'Tor');

INSERT INTO `MARVEL`.`SKILLS` (`ID`, `SKILL`) VALUES ('1', 'God');
INSERT INTO `MARVEL`.`SKILLS` (`ID`, `SKILL`) VALUES ('2', 'Rich');
INSERT INTO `MARVEL`.`SKILLS` (`ID`, `SKILL`) VALUES ('3', 'Alian');
INSERT INTO `MARVEL`.`SKILLS` (`ID`, `SKILL`) VALUES ('4', 'Immortal mutant');

INSERT INTO `MARVEL`.`SUPERHERO_SKILLS` (`SUPERHERO_ID`, `SKILLS_ID`) VALUES ('1', '3');
INSERT INTO `MARVEL`.`SUPERHERO_SKILLS` (`SUPERHERO_ID`, `SKILLS_ID`) VALUES ('2', '2');
INSERT INTO `MARVEL`.`SUPERHERO_SKILLS` (`SUPERHERO_ID`, `SKILLS_ID`) VALUES ('3', '4');
INSERT INTO `MARVEL`.`SUPERHERO_SKILLS` (`SUPERHERO_ID`, `SKILLS_ID`) VALUES ('4', '1');
UPDATE `MARVEL`.`SUPERHERO_SKILLS` SET `SKILLS_ID`='1' WHERE `SUPERHERO_ID`='3' and`SKILLS_ID`='4';
INSERT INTO `MARVEL`.`SUPERHERO_SKILLS` (`SUPERHERO_ID`, `SKILLS_ID`) VALUES ('4', '4');

SELECT DISTINCT t1.NAME, t3.SKILL
FROM MARVEL.SUPERHERO t1
INNER JOIN MARVEL.SUPERHERO_SKILLS t2
ON t1.ID=t2.SUPERHERO_ID
INNER JOIN MARVEL.SKILLS t3
ON t2.SKILLS_ID=t3.ID

--SQL-EX.ru

Select t1.avg_price
from  (select count(column1) as avg_price from table1) as t1



